---
import Layout from "@/layouts/Layout.astro";

export const prerender = false;

const user = Astro.locals.user;

if (!user) {
  return Astro.redirect("/auth/login");
}
---

<Layout title="Start Workout - Gym Track">
  <div class="container mx-auto px-4 py-8 sm:px-6 lg:px-8">
    <!-- Back Button -->
    <a
      href="/dashboard"
      class="mb-6 inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground"
    >
      <span class="material-symbols-outlined text-base">arrow_back</span>
      Powrót do dashboard
    </a>

    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold tracking-tight sm:text-4xl">Rozpocznij trening</h1>
      <p class="mt-2 text-muted-foreground">Wybierz plan treningowy, aby rozpocząć sesję</p>
    </div>

    <!-- Active Workout Alert -->
    <div class="mb-6 hidden rounded-lg border border-warning bg-warning/10 p-4" id="active-workout-alert">
      <div class="flex items-start gap-3">
        <span class="material-symbols-outlined text-warning">info</span>
        <div class="flex-1">
          <h3 class="font-semibold text-warning">Masz aktywny trening</h3>
          <p class="mt-1 text-sm text-muted-foreground">Dokończ lub anuluj obecny trening przed rozpoczęciem nowego</p>
          <a
            href="/workouts/active"
            class="mt-3 inline-flex items-center gap-2 text-sm font-medium text-warning hover:underline"
          >
            Przejdź do aktywnego treningu
            <span class="material-symbols-outlined text-base">arrow_forward</span>
          </a>
        </div>
      </div>
    </div>

    <!-- Workout Plans List -->
    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
      <!-- Plan Card Template -->
      <button
        class="group cursor-pointer rounded-lg border bg-card p-6 text-left shadow-sm transition-all hover:border-primary hover:shadow-md"
        onclick="console.log('Start workout with plan')"
      >
        <div class="mb-4 flex items-start justify-between">
          <div>
            <h3 class="mb-1 text-lg font-semibold group-hover:text-primary">Plan Name</h3>
            <p class="text-sm text-muted-foreground">X ćwiczeń</p>
          </div>
          <span class="material-symbols-outlined text-2xl text-primary">play_circle</span>
        </div>
        <p class="mb-4 text-sm text-muted-foreground line-clamp-2">Plan description will be loaded here...</p>
        <div class="flex items-center gap-2 text-xs text-muted-foreground">
          <span class="material-symbols-outlined text-sm">event</span>
          Ostatni trening: DD/MM/YYYY
        </div>
      </button>
    </div>

    <!-- Empty State -->
    <div class="rounded-lg border bg-card p-12 text-center shadow-sm hidden" id="empty-state">
      <span class="material-symbols-outlined mb-4 text-6xl text-muted-foreground">list_alt</span>
      <h3 class="mb-2 text-lg font-semibold">Brak planów treningowych</h3>
      <p class="mb-6 text-sm text-muted-foreground">Stwórz plan treningowy, aby móc rozpocząć trening</p>
      <a
        href="/workout-plans/new"
        class="inline-flex items-center gap-2 rounded-lg bg-primary px-6 py-3 text-sm font-medium text-primary-foreground hover:bg-primary/90"
      >
        <span class="material-symbols-outlined text-base">add</span>
        Stwórz plan treningowy
      </a>
    </div>
  </div>
</Layout>

<script>
  console.log("Start workout page loaded"); // Will check for active workout via API and show alert if exists // Will load
available workout plans from API
</script>
